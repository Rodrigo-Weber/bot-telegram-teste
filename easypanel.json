{
    "name": "finance-bot",
    "description": "Bot Financeiro para Telegram com controle de despesas e receitas",
    "version": "1.0.0",
    "type": "application",
    "services": [
        {
            "name": "finance-bot",
            "type": "docker",
            "image": "finance-bot:latest",
            "build": {
                "context": ".",
                "dockerfile": "Dockerfile"
            },
            "environment": [
                "TELEGRAM_TOKEN",
                "DB_HOST",
                "DB_DATABASE",
                "DB_USER",
                "DB_PASSWORD",
                "MERCADO_PAGO_ACCESS_TOKEN",
                "PAYER_EMAIL",
                "RECIPIENT_DISPLAY_NAME",
                "OWNER_USER_ID",
                "SUPPORT_NAME",
                "SUPPORT_EMAIL",
                "SUPPORT_PHONE"
            ],
            "volumes": [
                "./logs:/app/logs"
            ],
            "restart": "unless-stopped",
            "depends_on": [
                "mysql"
            ]
        },
        {
            "name": "mysql",
            "type": "mysql",
            "version": "8.0",
            "environment": [
                "MYSQL_ROOT_PASSWORD",
                "MYSQL_DATABASE",
                "MYSQL_USER",
                "MYSQL_PASSWORD"
            ],
            "volumes": [
                "mysql_data:/var/lib/mysql",
                "./init.sql:/docker-entrypoint-initdb.d/init.sql"
            ],
            "ports": [
                "3306:3306"
            ],
            "restart": "unless-stopped"
        }
    ],
    "volumes": {
        "mysql_data": {}
    },
    "networks": {
        "bot-network": {
            "driver": "bridge"
        }
    },
    "deploy": {
        "strategy": "recreate",
        "restart_policy": {
            "condition": "on-failure",
            "delay": "5s",
            "max_attempts": 3
        }
    }
}